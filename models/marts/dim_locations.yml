version: 2

models:
  - name: dim_locations
    description: "This model provides a comprehensive view of location data, including unique identifiers, names, tax rates, and opening dates, sourced from the 'stg_jaffle_shop__locations' staging model. It is materialized as an Iceberg table for efficient querying and storage in an external S3 volume. Location dimension table. The grain of the table is one row per location.\n"
    columns:
      - name: location_id
        data_type: varchar
        description: A unique identifier for each location.
        constraints:
          - type: not_null

        entity:
          type: primary
          name: location
      - name: location_name
        data_type: varchar
        description: The name of the location.

        dimension:
          type: categorical
      - name: tax_rate
        data_type: float
        description: The tax rate applicable to the location.

      - name: opened_date
        data_type: timestamp_ntz
        description: The date when the location was opened.


        dimension:
          type: time
        granularity: day
    config:
      contract:
        enforced: true

    semantic_model:
      enabled: true
    agg_time_dimension: opened_date
    metrics:
      - name: average_tax_rate
        description: Average tax rate.
        expr: tax_rate
        agg: average
        type: simple
        hidden: true